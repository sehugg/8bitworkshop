{
  "version": 3,
  "sources": ["../src/common/util.ts", "../src/common/vlist.ts", "../src/common/emu.ts"],
  "sourcesContent": ["\nexport function lpad(s:string, n:number):string {\n  s += ''; // convert to string\n  while (s.length<n) s=\" \"+s;\n  return s;\n}\n\nexport function rpad(s:string, n:number):string {\n  s += ''; // convert to string\n  while (s.length<n) s+=\" \";\n  return s;\n}\n\nexport function byte2signed(b:number):number {\n  b &= 0xff;\n  return (b < 0x80) ? b : -(256-b);\n}\n\nexport function getFilenameForPath(s:string):string {\n  var toks = s.split('/');\n  return toks[toks.length-1];\n}\n\nexport function getFolderForPath(s:string):string {\n  return s.substring(0, s.lastIndexOf('/'));\n}\n\nexport function getFilenamePrefix(s:string):string {\n  var pos = s.lastIndexOf('.');\n  return (pos > 0) ? s.substr(0, pos) : s;\n}\n\nexport function hex(v:number, nd?:number) {\n  if (!nd) nd = 2;\n  if (nd == 8) {\n    return hex((v>>16)&0xffff,4) + hex(v&0xffff,4);\n  } else {\n    return toradix(v,nd,16);\n  }\n}\n\nexport function tobin(v:number, nd?:number) {\n  if (!nd) nd = 8;\n  return toradix(v,nd,2);\n}\n\nexport function toradix(v:number, nd:number, radix:number) {\n  try {\n    var s = v.toString(radix).toUpperCase();\n    while (s.length < nd)\n      s = \"0\" + s;\n    return s;\n  } catch (e) {\n    return v+\"\";\n  }\n}\n\nexport function arrayCompare(a:ArrayLike<any>, b:ArrayLike<any>):boolean {\n  if (a == null && b == null) return true;\n  if (a == null) return false;\n  if (b == null) return false;\n  if (a.length != b.length) return false;\n  for (var i=0; i<a.length; i++)\n    if (a[i] != b[i])\n      return false;\n  return true;\n}\n\nexport function invertMap(m:{}):{} {\n  var r = {};\n  if (m) {\n    for (var k in m) r[m[k]] = k;\n  }\n  return r;\n}\n\nexport function highlightDifferences(s1:string, s2:string):string {\n  var split1 = s1.split(/(\\S+\\s+)/).filter(function(n) {return n});\n  var split2 = s2.split(/(\\S+\\s+)/).filter(function(n) {return n});\n  var i = 0;\n  var j = 0;\n  var result = \"\";\n  while (i < split1.length && j < split2.length) {\n    var w1 = split1[i];\n    var w2 = split2[j];\n    if (w2 && w2.indexOf(\"\\n\") >= 0) {\n      while (i < s1.length && split1[i].indexOf(\"\\n\") < 0)\n        i++;\n    }\n    if (w1 != w2) {\n      w2 = '<span class=\"hilite\">' + w2 + '</span>';\n    }\n    result += w2;\n    i++;\n    j++;\n  }\n  while (j < split2.length) {\n      result += split2[j++];\n  }\n  return result;\n}\n\nexport function lzgmini() {\n\n  // Constants\n  var LZG_HEADER_SIZE = 16;\n  var LZG_METHOD_COPY = 0;\n  var LZG_METHOD_LZG1 = 1;\n\n  // LUT for decoding the copy length parameter\n  var LZG_LENGTH_DECODE_LUT = [2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,\n                               20,21,22,23,24,25,26,27,28,29,35,48,72,128];\n\n  // Decoded data (produced by the decode() method)\n  var outdata = null;\n\n  // Calculate the checksum\n  var calcChecksum = function(data) {\n    var a = 1;\n    var b = 0;\n    var i = LZG_HEADER_SIZE;\n    while (i < data.length)\n    {\n      a = (a + (data[i] & 0xff)) & 0xffff;\n      b = (b + a) & 0xffff;\n      i++;\n    }\n    return (b << 16) | a;\n  }\n\n  // Decode LZG coded data. The function returns the size of the decoded data.\n  // Use any of the get* methods to retrieve the decoded data.\n  this.decode = function(data:number[]):number[] {\n    // Start by clearing the decompressed array in this object\n    outdata = null;\n\n    // Check magic ID\n    if ((data.length < LZG_HEADER_SIZE) || (data[0] != 76) ||\n         (data[1] != 90) || (data[2] != 71))\n    {\n      return null;\n    }\n    \n    // what's the length?\n    var uncomplen = data[6] | (data[5]<<8) | (data[4]<<16) | (data[3]<<24);\n\n    // Calculate & check the checksum\n    var checksum = ((data[11] & 0xff) << 24) |\n                   ((data[12] & 0xff) << 16) |\n                   ((data[13] & 0xff) << 8) |\n                   (data[14] & 0xff);\n    if (calcChecksum(data) != checksum)\n    {\n      return null;\n    }\n\n    var dst = new Array();\n    // Check which method to use\n    var method = data[15] & 0xff;\n    if (method == LZG_METHOD_LZG1)\n    {\n      // Get marker symbols\n      var m1 = data[16] & 0xff;\n      var m2 = data[17] & 0xff;\n      var m3 = data[18] & 0xff;\n      var m4 = data[19] & 0xff;\n\n      // Main decompression loop\n      var symbol, b, b2, b3, len, offset;\n      var dstlen = 0;\n      var k = LZG_HEADER_SIZE + 4;\n      var datalen = data.length;\n      while (k <= datalen)\n      {\n        symbol = data[k++] & 0xff;\n        if ((symbol != m1) && (symbol != m2) && (symbol != m3) && (symbol != m4))\n        {\n          // Literal copy\n          dst[dstlen++] = symbol;\n        }\n        else\n        {\n          b = data[k++] & 0xff;\n          if (b != 0)\n          {\n            // Decode offset / length parameters\n            if (symbol == m1)\n            {\n              // marker1 - \"Distant copy\"\n              len = LZG_LENGTH_DECODE_LUT[b & 0x1f];\n              b2 = data[k++] & 0xff;\n              b3 = data[k++] & 0xff;\n              offset = (((b & 0xe0) << 11) | (b2 << 8) | b3) + 2056;\n            }\n            else if (symbol == m2)\n            {\n              // marker2 - \"Medium copy\"\n              len = LZG_LENGTH_DECODE_LUT[b & 0x1f];\n              b2 = data[k++] & 0xff;\n              offset = (((b & 0xe0) << 3) | b2) + 8;\n            }\n            else if (symbol == m3)\n            {\n              // marker3 - \"Short copy\"\n              len = (b >> 6) + 3;\n              offset = (b & 63) + 8;\n            }\n            else\n            {\n              // marker4 - \"Near copy (incl. RLE)\"\n              len = LZG_LENGTH_DECODE_LUT[b & 0x1f];\n              offset = (b >> 5) + 1;\n            }\n\n            // Copy the corresponding data from the history window\n            for (i = 0; i < len; i++)\n            {\n              dst[dstlen] = dst[dstlen-offset];\n              dstlen++;\n            }\n          }\n          else\n          {\n            // Literal copy (single occurance of a marker symbol)\n            dst[dstlen++] = symbol;\n          }\n        }\n      }\n\n    }\n    else if (method == LZG_METHOD_COPY)\n    {\n      // Plain copy\n      var dstlen = 0;\n      var datalen = data.length;\n      for (var i = LZG_HEADER_SIZE; i < datalen; i++)\n      {\n        dst[dstlen++] = data[i] & 0xff;\n      }\n    }\n    else\n    {\n      // Unknown method\n      return null;\n    }\n    // Store the decompressed data in the lzgmini object for later retrieval\n    if (dst.length < uncomplen) return null; // data too short\n    outdata = dst.slice(0, uncomplen);\n    return outdata;\n  }\n\n  // Get the decoded byte array\n  this.getByteArray = function():number[]\n  {\n    return outdata;\n  }\n\n  // Get the decoded string from a Latin 1 (or ASCII) encoded array\n  this.getStringLatin1 = function():string {\n    return byteArrayToString(outdata);\n  }\n\n  // Get the decoded string from an UTF-8 encoded array\n  this.getStringUTF8 = function():string {\n    return byteArrayToUTF8(outdata);\n  }\n}\n\nexport function stringToByteArray(s:string) : Uint8Array {\n  var a = new Uint8Array(s.length);\n  for (var i=0; i<s.length; i++)\n    a[i] = s.charCodeAt(i);\n  return a;\n}\n\nexport function byteArrayToString(data : number[] | Uint8Array) : string {\n  var str = \"\";\n  if (data != null) {\n    var charLUT = new Array();\n    for (var i = 0; i < 256; ++i)\n      charLUT[i] = String.fromCharCode(i);\n    var len = data.length;\n    for (var i = 0; i < len; i++)\n      str += charLUT[data[i]];\n  }\n  return str;\n}\n\nexport function byteArrayToUTF8(data : number[] | Uint8Array) : string {\n  var str = \"\";\n  var charLUT = new Array();\n  for (var i = 0; i < 128; ++i)\n    charLUT[i] = String.fromCharCode(i);\n  var c;\n  var len = data.length;\n  for (var i = 0; i < len;) {\n    c = data[i++];\n    if (c < 128) {\n      str += charLUT[c];\n    } else {\n      if ((c >= 192) && (c < 224)) {\n        c = ((c & 31) << 6) | (data[i++] & 63);\n      } else {\n        c = ((c & 15) << 12) | ((data[i] & 63) << 6) | (data[i+1] & 63);\n        i += 2;\n        if (c == 0xfeff) continue; // ignore BOM\n      }\n      str += String.fromCharCode(c);\n    }\n  }\n  return str;\n}\n\nexport function removeBOM(s:string) {\n  if (s.charCodeAt(0) === 0xFEFF) {\n    s = s.substr(1);\n  }\n  return s;\n}\n\nexport function isProbablyBinary(path:string, data?:number[] | Uint8Array) : boolean {\n  var score = 0;\n  // check extensions\n  if (path) {\n    path = path.toUpperCase();\n    const BINEXTS = ['.CHR','.BIN','.DAT','.PAL','.NAM','.RLE','.LZ4','.NSF'];\n    for (var ext of BINEXTS) {\n      if (path.endsWith(ext)) score++;\n    }\n  }\n  // decode as UTF-8\n  for (var i = 0; i < (data?data.length:0);) {\n    let c = data[i++];\n    if ((c & 0x80) == 0) {\n      // more likely binary if we see a NUL or obscure control character\n      if (c < 9 || (c >= 14 && c < 26) || c == 0x7f) {\n        score++;\n        break;\n      }\n    } else {\n      // look for invalid unicode sequences\n      var nextra = 0;\n      if ((c & 0xe0) == 0xc0) nextra = 1;\n      else if ((c & 0xf0) == 0xe0) nextra = 2;\n      else if ((c & 0xf8) == 0xf0) nextra = 3;\n      else if (c < 0xa0) score++;\n      else if (c == 0xff) score++;\n      while (nextra--) {\n        if (i >= data.length || (data[i++] & 0xc0) != 0x80) {\n          score++;\n          break;\n        }\n      }\n    }\n  }\n  return score > 0;\n}\n\n// need to load liblzg.js first\nexport function compressLZG(em_module, inBuffer:number[], levelArg?:boolean) : Uint8Array {\n  var level = levelArg || 9;\n  var inLen = inBuffer.length;\n  var inPtr = em_module._malloc(inLen + 1);\n  for (var i = 0; i < inLen; i++) {\n      em_module.setValue(inPtr + i, inBuffer[i], 'i8');\n  }\n  var maxEncSize = em_module._LZG_MaxEncodedSize(inLen);\n  var outPtr = em_module._malloc(maxEncSize + 1);\n  var compLen = em_module.ccall('compress_lzg', 'number', ['number', 'number', 'number', 'number', 'number'], [level, inPtr, inLen, maxEncSize, outPtr]);\n  em_module._free(inPtr);\n  var outBuffer = new Uint8Array(compLen);\n  for (var i = 0; i < compLen; i++) {\n      outBuffer[i] = em_module.getValue(outPtr + i, 'i8');\n  }\n  em_module._free(outPtr);\n  return outBuffer;\n}\n\n// only does primitives, 1D arrays and no recursion\nexport function safe_extend(deep, dest, src) {\n  // TODO: deep ignored\n  for (var key in src) {\n    var val = src[key];\n    var type = typeof(val);\n    if (val === null || type == 'undefined') {\n      dest[key] = val;\n    } else if (type == 'function') {\n      // ignore function\n    } else if (type == 'object') {\n      if (val['slice']) { // array?\n        dest[key] = val.slice();\n      } else {\n        // ignore object\n      }\n    } else {\n      dest[key] = val;\n    }\n  }\n  return dest;\n}\n\nexport function printFlags(val:number, names:string[], r2l:boolean) {\n  var s = '';\n  for (var i=0; i<names.length; i++) {\n    if (names[i]) {\n      var bit = 1 << (r2l ? (names.length-1-i) : i);\n      if (i > 0) s += \" \";\n      s += (val & bit) ? names[i] : \"-\";\n    }\n  }\n  return s;\n}\n\nexport function rgb2bgr(x) {\n  return ((x&0xff)<<16) | ((x>>16)&0xff) | (x&0x00ff00);\n}\n\nexport function RGBA(r:number,g:number,b:number) {\n  return (r&0xff) | ((g&0xff)<<8) | ((b&0xff)<<16) | 0xff000000;\n}\n\nexport function clamp(minv:number, maxv:number, v:number) {\n  return (v < minv) ? minv : (v > maxv) ? maxv : v;\n}\n\nexport function safeident(s : string) : string {\n  // if starts with non-alpha character, prefix with '_'\n  if (s.length == 0) return '';\n  if (!s.match(/^[a-zA-Z_]/)) s = '_' + s;\n  return s.replace(/\\W+/g, \"_\");\n}\n\nexport function rle_unpack(src : Uint8Array) : Uint8Array {\n  var i = 0;\n  var tag = src[i++];\n  var dest = [];\n  var data = tag;\n  while (i < src.length) {\n    var ch = src[i++];\n    if (ch == tag) {\n      var count = src[i++];\n      for (var j=0; j<count; j++)\n        dest.push(data);\n      if (count == 0)\n        break;\n    } else {\n      data = ch;\n      dest.push(data);\n    }\n  }\n  return new Uint8Array(dest);\n}\n\n// firefox doesn't do GET with binary files\n// TODO: replace with fetch()?\nexport function getWithBinary(url:string, success:(text:string|Uint8Array)=>void, datatype:'text'|'arraybuffer') {\n  var oReq = new XMLHttpRequest();\n  oReq.open(\"GET\", url, true);\n  oReq.responseType = datatype;\n  oReq.onload = function (oEvent) {\n    if (oReq.status == 200) {\n      var data = oReq.response;\n      if (data instanceof ArrayBuffer) {\n        data = new Uint8Array(data);\n      }\n      success(data);\n    } else if (oReq.status == 404) {\n      success(null);\n    } else {\n      throw Error(\"Error \" + oReq.status + \" loading \" + url);\n    }\n  }\n  oReq.onerror = function (oEvent) {\n    success(null);\n  }\n  oReq.ontimeout = function (oEvent) {\n    throw Error(\"Timeout loading \" + url);\n  }\n  oReq.send(null);\n}\n\n// get platform ID without . emulator\nexport function getBasePlatform(platform : string) : string {\n  return platform.split('.')[0];\n}\n\n// get platform ID without - specialization\nfunction getRootPlatform(platform : string) : string {\n  return platform.split('-')[0];\n}\n\n// get platform ID without emulator or specialization\nexport function getRootBasePlatform(platform : string) : string {\n  return getRootPlatform(getBasePlatform(platform));\n}\n\nexport function isArray(obj: any) : obj is ArrayLike<any> {\n  return obj != null && (Array.isArray(obj) || isTypedArray(obj));\n}\n\nexport function isTypedArray(obj: any) : obj is ArrayLike<number> {\n  return obj != null && obj['BYTES_PER_ELEMENT'];\n}\n\nexport function convertDataToUint8Array(data: string|Uint8Array) : Uint8Array {\n  return (typeof data === 'string') ? stringToByteArray(data) : data;\n}\n\nexport function convertDataToString(data: string|Uint8Array) : string {\n  return (data instanceof Uint8Array) ? byteArrayToUTF8(data) : data;\n}\n\nexport function byteToASCII(b: number) : string {\n  if (b < 32)\n    return String.fromCharCode(b + 0x2400);\n  else\n    return String.fromCharCode(b);\n}\n\nexport function loadScript(scriptfn:string) : Promise<Event> {\n  return new Promise( (resolve, reject) => {\n    var script = document.createElement('script');\n    script.onload = resolve;\n    script.onerror = reject;\n    script.src = scriptfn;\n    document.getElementsByTagName('head')[0].appendChild(script);\n  });\n}\n\nexport function decodeQueryString(qs : string) : {} {\n  if (qs.startsWith('?')) qs = qs.substr(1);\n  var a = qs.split('&');\n  if (!a || a.length == 0)\n      return {};\n  var b = {};\n  for (var i = 0; i < a.length; ++i) {\n      var p = a[i].split('=', 2);\n      if (p.length == 1)\n          b[p[0]] = \"\";\n      else\n          b[p[0]] = decodeURIComponent(p[1].replace(/\\+/g, \" \"));\n  }\n  return b;\n}\n\nexport function parseBool(s : string) : boolean {\n  if (!s) return false;\n  if (s == 'false' || s == '0') return false;\n  if (s == 'true' || s == '1') return true;\n  return s ? true : false;\n}\n\n///\n\nexport class XMLParseError extends Error {\n}\n\nexport interface XMLNode {\n  type: string;\n  text: string | null;\n  children: XMLNode[];\n  attrs: { [id: string]: string };\n  obj: any;\n}\n\nexport type XMLVisitFunction = (node: XMLNode) => any;\n\nfunction escapeXML(s: string): string {\n  if (s.indexOf('&') >= 0) {\n      return s.replace(/&apos;/g, \"'\")\n          .replace(/&quot;/g, '\"')\n          .replace(/&gt;/g, '>')\n          .replace(/&lt;/g, '<')\n          .replace(/&amp;/g, '&');\n  } else {\n      return s;\n  }\n}\n\nexport function parseXMLPoorly(s: string, openfn?: XMLVisitFunction, closefn?: XMLVisitFunction): XMLNode {\n  const tag_re = /[<]([/]?)([?a-z_-]+)([^>]*)[>]+|(\\s*[^<]+)/gi;\n  const attr_re = /\\s*(\\w+)=\"(.*?)\"\\s*/gi;\n  var fm: RegExpMatchArray;\n  var stack: XMLNode[] = [];\n  var top: XMLNode;\n\n  function closetop() {\n      top = stack.pop();\n      if (top == null || top.type != ident) throw new XMLParseError(\"mismatch close tag: \" + ident);\n      if (closefn) {\n          top.obj = closefn(top);\n      }\n      if (stack.length == 0) throw new XMLParseError(\"close tag without open: \" + ident);\n      stack[stack.length - 1].children.push(top);\n  }\n  function parseattrs(as: string): { [id: string]: string } {\n      var am;\n      var attrs = {};\n      if (as != null) {\n          while (am = attr_re.exec(as)) {\n              attrs[am[1]] = escapeXML(am[2]);\n          }\n      }\n      return attrs;\n  }\n  while (fm = tag_re.exec(s)) {\n      var [_m0, close, ident, attrs, content] = fm;\n      //console.log(stack.length, close, ident, attrs, content);\n      if (close) {\n          closetop();\n      } else if (ident) {\n          var node = { type: ident, text: null, children: [], attrs: parseattrs(attrs), obj: null };\n          stack.push(node);\n          if (attrs) {\n              parseattrs(attrs);\n          }\n          if (openfn) {\n              node.obj = openfn(node);\n          }\n          if (attrs && attrs.endsWith('/')) closetop();\n      } else if (content != null) {\n          if (stack.length == 0) throw new XMLParseError(\"content without element\");\n          var txt = escapeXML(content as string).trim();\n          if (txt.length) stack[stack.length - 1].text = txt;\n      }\n  }\n  if (stack.length != 1) throw new XMLParseError(\"tag not closed\");\n  if (stack[0].type != '?xml') throw new XMLParseError(\"?xml needs to be first element\");\n  return top;\n}\n\nexport function escapeHTML(s: string): string {\n  return s.replace(/[&]/g, '&amp;').replace(/[<]/g, '&lt;').replace(/[>]/g, '&gt;');\n}\n\n// lame factorization for displaying bitmaps\n// returns a > b such that a * b == x (or higher), a >= mina, b >= minb\nexport function findIntegerFactors(x: number, mina: number, minb: number, aspect: number) : {a: number, b: number} {\n  let a = x;\n  let b = 1;\n  if (minb > 1 && minb < a) {\n    a = Math.ceil(x / minb);\n    b = minb;\n  }\n  while (a > b) {\n    let a2 = a;\n    let b2 = b;\n    if ((a & 1) == 0) {\n      b2 = b * 2;\n      a2 = a / 2;\n    }\n    if ((a % 3) == 0) {\n      b2 = b * 3;\n      a2 = a / 3;\n    }\n    if ((a % 5) == 0) {\n      b2 = b * 5;\n      a2 = a / 5;\n    }\n    if (a2 < mina) break;\n    if (a2 < b2 * aspect) break;\n    a = a2;\n    b = b2;\n  }\n  return {a, b};\n}\n\nexport class FileDataCache {\n  maxSize : number = 8000000;\n  size : number;\n  cache : Map<string, string|Uint8Array>;\n  constructor() {\n    this.reset();\n  }\n  get(key : string) : string|Uint8Array {\n    return this.cache.get(key);\n  }\n  put(key : string, value : string|Uint8Array) {\n    this.cache.set(key, value);\n    this.size += value.length;\n    if (this.size > this.maxSize) {\n      console.log('cache reset', this);\n      this.reset();\n    }\n  }\n  reset() {\n    this.cache = new Map();\n    this.size = 0;\n  }\n}\n\nexport function coerceToArray<T>(arrobj: any) : T[] {\n    if (Array.isArray(arrobj)) return arrobj;\n    else if (arrobj != null && typeof arrobj[Symbol.iterator] === 'function') return Array.from(arrobj);\n    else if (typeof arrobj === 'object') return Array.from(Object.values(arrobj))\n    else throw new Error(`Expected array or object, got \"${arrobj}\"`);\n}\n\nexport function replaceAll(s:string, search:string, replace:string) : string {\n  if (s == '') return '';\n  if (search == '') return s;\n  return s.split(search).join(replace);\n}\n\nexport function getCookie(name: string) : string {\n  var nameEQ = name + \"=\";\n  var ca = document.cookie.split(';');\n  for(var i=0;i < ca.length;i++) {\n      var c = ca[i];\n      while (c.charAt(0)==' ') c = c.substring(1,c.length);\n      if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n  }\n  return null;\n}\n\n", "/**\n * The MIT License (MIT)\n *\n * Copyright (C) 2013 Sergi Mansilla\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n/**\n * Creates a virtually-rendered scrollable list.\n * @param {object} config\n * @constructor\n */\nexport function VirtualList(config) {\n  var width = (config && config.w + 'px') || '100%';\n  var height = (config && config.h + 'px') || '100%';\n  var itemHeight = this.itemHeight = config.itemHeight;\n\n  this.items = config.items;\n  this.generatorFn = config.generatorFn;\n  this.totalRows = config.totalRows || (config.items && config.items.length);\n\n  var scroller = VirtualList.createScroller(itemHeight * this.totalRows);\n  this.container = VirtualList.createContainer(width, height);\n  this.container.appendChild(scroller);\n\n  var screenItemsLen = Math.ceil(config.h / itemHeight);\n  // Cache 4 times the number of items that fit in the container viewport\n  this.cachedItemsLen = screenItemsLen * 3;\n  this._renderChunk(this.container, 0);\n\n  var self = this;\n  var lastRepaintY;\n  var maxBuffer = screenItemsLen * itemHeight;\n  var lastScrolled = 0;\n\n  // As soon as scrolling has stopped, this interval asynchronouslyremoves all\n  // the nodes that are not used anymore\n  this.rmNodeInterval = setInterval(function() {\n    if (Date.now() - lastScrolled > 100) {\n      var badNodes = document.querySelectorAll('[data-rm=\"1\"]');\n      for (var i = 0, l = badNodes.length; i < l; i++) {\n        try {\n          self.container.removeChild(badNodes[i]);\n        } catch (e) {\n          //\n        }\n      }\n    }\n  }, 300);\n\n  function onScroll(e) {\n    var scrollTop = e.target.scrollTop; // Triggers reflow\n    if (!lastRepaintY || Math.abs(scrollTop - lastRepaintY) > maxBuffer) {\n      var first = Math.floor(scrollTop / itemHeight) - screenItemsLen;\n      self._renderChunk(self.container, first < 0 ? 0 : first);\n      lastRepaintY = scrollTop;\n    }\n\n    lastScrolled = Date.now();\n    e.preventDefault && e.preventDefault();\n  }\n\n  this.container.addEventListener('scroll', onScroll);\n}\n\nVirtualList.prototype.createRow = function(i) {\n  var item;\n  if (this.generatorFn)\n    item = this.generatorFn(i);\n  else if (this.items) {\n    if (typeof this.items[i] === 'string') {\n      var itemText = document.createTextNode(this.items[i]);\n      item = document.createElement('div');\n      item.style.height = this.itemHeight + 'px';\n      item.appendChild(itemText);\n    } else {\n      item = this.items[i];\n    }\n  }\n\n  item.classList.add('vrow');\n  item.setAttribute('data-index', ''+i);\n  item.style.position = 'absolute';\n  item.style.top = (i * this.itemHeight) + 'px';\n  return item;\n};\n\n/**\n * Renders a particular, consecutive chunk of the total rows in the list. To\n * keep acceleration while scrolling, we mark the nodes that are candidate for\n * deletion instead of deleting them right away, which would suddenly stop the\n * acceleration. We delete them once scrolling has finished.\n *\n * @param {Node} node Parent node where we want to append the children chunk.\n * @param {Number} from Starting position, i.e. first children index.\n * @return {void}\n */\nVirtualList.prototype._renderChunk = function(node, from) {\n  var finalItem = from + this.cachedItemsLen;\n  if (finalItem > this.totalRows)\n    finalItem = this.totalRows;\n\n  // Append all the new rows in a document fragment that we will later append to\n  // the parent node\n  var fragment = document.createDocumentFragment();\n  for (var i = from; i < finalItem; i++) {\n    fragment.appendChild(this.createRow(i));\n  }\n\n  // Hide and mark obsolete nodes for deletion.\n  for (var j = 1, l = node.childNodes.length; j < l; j++) {\n    node.childNodes[j].style.display = 'none';\n    node.childNodes[j].setAttribute('data-rm', '1');\n  }\n  node.appendChild(fragment);\n};\n\nVirtualList.createContainer = function(w, h) {\n  var c = document.createElement('div');\n  c.classList.add('vlist');\n  c.style.width = w;\n  c.style.height = h;\n  c.style.overflow = 'auto';\n  c.style.position = 'relative';\n  c.style.padding = '0';\n  c.style.border = '1px solid black';\n  return c;\n};\n\nVirtualList.createScroller = function(h) {\n  var scroller = document.createElement('div');\n  scroller.style.opacity = '0';\n  scroller.style.position = 'absolute';\n  scroller.style.top = '0';\n  scroller.style.left = '0';\n  scroller.style.width = '1px';\n  scroller.style.height = h + 'px';\n  return scroller;\n};\n\nVirtualList.prototype.scrollToItem = function(index) {\n  this.container.scrollTop = this.itemHeight * index;\n};\n\n", "\nimport { hex, clamp, lpad, RGBA } from \"./util\";\nimport { SourceLocation } from \"./workertypes\";\nimport { VirtualList } from \"./vlist\"\n\n// Emulator classes\n\nexport var PLATFORMS = {};\n\nvar _random_state = 1;\n\nexport function noise() {\n\tlet x = _random_state;\n\tx ^= x << 13;\n\tx ^= x >> 17;\n\tx ^= x << 5;\n\treturn (_random_state = x) & 0xff;\n}\n\nexport function getNoiseSeed() {\n  return _random_state;\n}\n\nexport function setNoiseSeed(x : number) {\n  _random_state = x;\n}\n\ntype KeyboardCallback = (which:number, charCode:number, flags:KeyFlags) => void;\n\nexport function __createCanvas(doc:HTMLDocument, mainElement:HTMLElement, width:number, height:number) : HTMLCanvasElement {\n  var canvas = doc.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  canvas.classList.add(\"emuvideo\");\n  canvas.tabIndex = -1;               // Make it focusable\n  mainElement.appendChild(canvas);\n  return canvas;\n}\n\nexport enum KeyFlags {\n  KeyDown = 1,\n  Shift = 2,\n  Ctrl = 4,\n  Alt = 8,\n  Meta = 16,\n  KeyUp = 64,\n  KeyPress = 128,\n}\n\n// TODO: don't use which/keyCode anymore?\n// TODO: let keycode = e.key ? e.key.charCodeAt(0) : e.keyCode;\n// TODO: let charCode = e.key ? e.key.charCodeAt(0) : e.charCode;\nexport function _setKeyboardEvents(canvas:HTMLElement, callback:KeyboardCallback) {\n  canvas.onkeydown = (e) => {\n    let flags = _metakeyflags(e);\n    callback(e.which, e.keyCode, KeyFlags.KeyDown|flags);\n    if (!flags) e.preventDefault(); // eat all keys that don't have a modifier\n  };\n  canvas.onkeyup = (e) => {\n    callback(e.which, e.keyCode, KeyFlags.KeyUp|_metakeyflags(e));\n  };\n};\n\ntype VideoCanvasOptions = {rotate?:number, overscan?:boolean, aspect?:number};\n\nexport class RasterVideo {\n\n  mainElement : HTMLElement;\n  width : number;\n  height : number;\n  options : VideoCanvasOptions;\n\n  constructor(mainElement:HTMLElement, width:number, height:number, options?:VideoCanvasOptions) {\n    this.mainElement = mainElement;\n    this.width = width;\n    this.height = height;\n    this.options = options;\n  }\n  \n  canvas : HTMLCanvasElement;\n  ctx : CanvasRenderingContext2D;\n  imageData : ImageData;\n  datau32 : Uint32Array;\n  vcanvas : JQuery;\n  \n  paddle_x = 255;\n  paddle_y = 255;\n  \n  setRotate(rotate:number) {\n    var canvas = this.canvas;\n    if (rotate) {\n      // TODO: aspect ratio?\n      canvas.style.transform = \"rotate(\"+rotate+\"deg)\";\n      if (canvas.width < canvas.height)\n        canvas.style.paddingLeft = canvas.style.paddingRight = \"10%\";\n    } else {\n      canvas.style.transform = null;\n      canvas.style.paddingLeft = canvas.style.paddingRight = null;\n    }\n  }\n\n  create(doc?: HTMLDocument) {\n    var canvas;\n    this.canvas = canvas = __createCanvas(doc || document, this.mainElement, this.width, this.height);\n    this.vcanvas = $(canvas);\n    if (this.options && this.options.rotate) {\n      this.setRotate(this.options.rotate);\n    }\n    if (this.options && this.options.overscan) {\n      this.vcanvas.css('padding','0px');\n    }\n    if (this.options && this.options.aspect) {\n      console.log(this.options);\n      this.vcanvas.css('aspect-ratio', this.options.aspect+\"\");\n    }\n    this.ctx = canvas.getContext('2d');\n    this.imageData = this.ctx.createImageData(this.width, this.height);\n    this.datau32 = new Uint32Array(this.imageData.data.buffer);\n  }\n\n  setKeyboardEvents(callback) {\n    _setKeyboardEvents(this.canvas, callback);\n  }\n\n  getFrameData() { return this.datau32; }\n\n  getContext() { return this.ctx; }\n\n  updateFrame(sx?:number, sy?:number, dx?:number, dy?:number, w?:number, h?:number) {\n    if (w && h)\n      this.ctx.putImageData(this.imageData, sx, sy, dx, dy, w, h);\n    else\n      this.ctx.putImageData(this.imageData, 0, 0);\n  }\n\n  clearRect(dx:number, dy:number, w:number, h:number) {\n    var ctx = this.ctx;\n    ctx.fillStyle = '#000000';\n    ctx.fillRect(dx, dy, w, h);\n  }\n\n  setupMouseEvents(el? : HTMLCanvasElement) {\n    if (!el) el = this.canvas;\n    $(el).mousemove( (e) => {\n      var pos = getMousePos(el, e);\n      var new_x = Math.floor(pos.x * 255 / this.canvas.width);\n      var new_y = Math.floor(pos.y * 255 / this.canvas.height);\n      this.paddle_x = clamp(0, 255, new_x);\n      this.paddle_y = clamp(0, 255, new_y);\n    });\n  };\n}\n\nexport class VectorVideo extends RasterVideo {\n\n  persistenceAlpha = 0.5;\n  jitter = 1.0;\n  gamma = 0.8;\n  sx : number;\n  sy : number;\n  \n  create() {\n    super.create();\n    this.sx = this.width/1024.0;\n    this.sy = this.height/1024.0;\n  }\n\n  clear() {\n    var ctx = this.ctx;\n    ctx.globalCompositeOperation = 'source-over';\n    ctx.globalAlpha = this.persistenceAlpha;\n    ctx.fillStyle = '#000000';\n    ctx.fillRect(0, 0, this.width, this.height);\n    ctx.globalAlpha = 1.0;\n    ctx.globalCompositeOperation = 'lighter';\n  }\n\n  COLORS = [\n    '#111111',\n    '#1111ff',\n    '#11ff11',\n    '#11ffff',\n    '#ff1111',\n    '#ff11ff',\n    '#ffff11',\n    '#ffffff'\n  ];\n\n  drawLine(x1:number, y1:number, x2:number, y2:number, intensity:number, color:number) {\n    var ctx = this.ctx;\n    var sx = this.sx;\n    var sy = this.sy;\n    //console.log(x1,y1,x2,y2,intensity,color);\n    if (intensity > 0) {\n      // TODO: landscape vs portrait\n      var alpha = Math.pow(intensity / 255.0, this.gamma);\n      ctx.globalAlpha = alpha;\n      ctx.lineWidth = 3;\n      ctx.beginPath();\n      // TODO: bright dots\n      var jx = this.jitter * (Math.random() - 0.5);\n      var jy = this.jitter * (Math.random() - 0.5);\n      x1 += jx;\n      x2 += jx;\n      y1 += jy;\n      y2 += jy;\n      ctx.moveTo(x1*sx, this.height-y1*sy);\n      if (x1 == x2 && y1 == y2)\n        ctx.lineTo(x2*sx+1, this.height-y2*sy);\n      else\n        ctx.lineTo(x2*sx, this.height-y2*sy);\n      ctx.strokeStyle = this.COLORS[color & 7];\n      ctx.stroke();\n    }\n  }\n}\n\nexport function drawCrosshair(ctx:CanvasRenderingContext2D, x:number, y:number, width:number) {\n  if (!ctx?.setLineDash) return; // for unit testing\n  ctx.fillStyle = 'rgba(0,0,0,0.25)';\n  ctx.fillRect(x-2, 0, 5, 32767);\n  ctx.fillRect(0, y-2, 32767, 5);\n  ctx.lineWidth = width;\n  ctx.strokeStyle = 'rgba(255,255,255,0.75)';\n  ctx.setLineDash([width*2,width*2]);\n  ctx.beginPath();\n  ctx.moveTo(x, 0);\n  ctx.lineTo(x, 32767);\n  ctx.moveTo(0, y);\n  ctx.lineTo(32767, y);\n  ctx.stroke();\n}\n\nexport class RAM {\n  mem : Uint8Array;\n  constructor(size:number) {\n    this.mem = new Uint8Array(new ArrayBuffer(size));\n  }\n}\n\nexport class EmuHalt extends Error {\n  $loc : SourceLocation;\n  squelchError = true;\n  constructor(msg: string, loc?: SourceLocation) {\n    super(msg);\n    this.$loc = loc;\n    Object.setPrototypeOf(this, EmuHalt.prototype);\n  }\n}\n\nexport var useRequestAnimationFrame : boolean = false;\n\nexport class AnimationTimer {\n\n  callback;  \n  running : boolean = false;\n  pulsing : boolean = false;\n  nextts = 0;\n  nframes;\n  startts; // for FPS calc\n  frameRate;\n  intervalMsec;\n  useReqAnimFrame = useRequestAnimationFrame && typeof window.requestAnimationFrame === 'function'; // need for unit test\n  \n  constructor(frequencyHz:number, callback:() => void) {\n    this.frameRate = frequencyHz;\n    this.intervalMsec = 1000.0 / frequencyHz;\n    this.callback = callback;\n  }\n\n  scheduleFrame(msec:number) {\n    var fn = (timestamp) => {\n      try {\n        this.nextFrame(this.useReqAnimFrame ? timestamp : Date.now());\n      } catch (e) {\n        this.running = false;\n        this.pulsing = false;\n        throw e;\n      }\n    }\n    if (this.useReqAnimFrame)\n      window.requestAnimationFrame(fn);\n    else\n      setTimeout(fn, msec);\n  }\n  \n  nextFrame(ts:number) {\n    if (ts > this.nextts) {\n      if (this.running) {\n        this.callback();\n      }\n      if (this.nframes == 0)\n        this.startts = ts;\n      if (this.nframes++ == 300) {\n        console.log(\"Avg framerate: \" + this.nframes*1000/(ts-this.startts) + \" fps\");\n      }\n    }\n    this.nextts += this.intervalMsec;\n    // frames skipped? catch up\n    if ((ts - this.nextts) > 1000) {\n      //console.log(ts - this.nextts, 'msec skipped');\n      this.nextts = ts;\n    }\n    if (this.running) {\n      this.scheduleFrame(this.nextts - ts);\n    } else {\n      this.pulsing = false;\n    }\n  }\n  isRunning() {\n    return this.running;\n  }\n  start() {\n    if (!this.running) {\n      this.running = true;\n      this.nextts = 0;\n      this.nframes = 0;\n      if (!this.pulsing) {\n        this.scheduleFrame(0);\n        this.pulsing = true;\n      }\n    }\n  }\n  stop() {\n    this.running = false;\n  }\n}\n\n// TODO: move to util?\n\nexport function dumpRAM(ram:ArrayLike<number>, ramofs:number, ramlen:number) : string {\n  var s = \"\";\n  var bpel = ram['BYTES_PER_ELEMENT'] || 1;\n  var perline = Math.ceil(16 / bpel);\n  var isFloat = ram instanceof Float32Array || ram instanceof Float64Array;\n  // TODO: show scrollable RAM for other platforms\n  for (var ofs=0; ofs<ramlen; ofs+=perline) {\n    s += '$' + hex(ofs+ramofs) + ':';\n    for (var i=0; i<perline; i++) {\n      if (ofs+i < ram.length) {\n        if (i == perline/2) s += \" \";\n        if (isFloat) s += \" \" + ram[ofs+i].toPrecision(bpel*2);\n        else s += \" \" + hex(ram[ofs+i], bpel*2);\n      }\n    }\n    s += \"\\n\";\n  }\n  return s;\n}\n\nexport interface KeyDef {\n  c:number,\t// key code\n  n:string,\t// name\n  // for gamepad\n  plyr?:number,\n  xaxis?:number,\n  yaxis?:number,\n  button?:number\n  };\n\nexport interface KeyMapEntry {\n  index:number;\n  mask:number;\n  def:KeyDef;\n}\n\ntype KeyCodeMap = Map<number,KeyMapEntry>;\n\nexport const Keys = {\n    ANYKEY:   {c: 0,   n: \"?\"},\n    // https://w3c.github.io/gamepad/#remapping\n    // gamepad and keyboard (player 0)\n    UP:       {c: 38,  n: \"Up\",    plyr:0, button:12, yaxis:-1},\n    DOWN:     {c: 40,  n: \"Down\",  plyr:0, button:13, yaxis:1},\n    LEFT:     {c: 37,  n: \"Left\",  plyr:0, button:14, xaxis:-1},\n    RIGHT:    {c: 39,  n: \"Right\", plyr:0, button:15, xaxis:1},\n    A:        {c: 32,  n: \"Space\", plyr:0, button:0},\n    B:        {c: 16,  n: \"Shift\", plyr:0, button:1},\n    GP_A:     {c: 88,  n: \"X\",     plyr:0, button:0},\n    GP_B:     {c: 90,  n: \"Z\",     plyr:0, button:1},\n    GP_C:     {c: 86,  n: \"V\",     plyr:0, button:2},\n    GP_D:     {c: 67,  n: \"C\",     plyr:0, button:3},\n    SELECT:   {c: 220, n: \"\\\\\",    plyr:0, button:8},\n    START:    {c: 13,  n: \"Enter\", plyr:0, button:9},\n    OPTION:   {c: 8,   n: \"Bcksp\", plyr:0, button:10},\n    // gamepad and keyboard (player 1)\n    P2_UP:       {c: 87, n: \"W\",  plyr:1, button:12, yaxis:-1},\n    P2_DOWN:     {c: 83, n: \"S\",  plyr:1, button:13, yaxis:1},\n    P2_LEFT:     {c: 65, n: \"A\",  plyr:1, button:14, xaxis:-1},\n    P2_RIGHT:    {c: 68, n: \"D\",  plyr:1, button:15, xaxis:1},\n    P2_A:        {c: 84, n: \"T\",  plyr:1, button:0},\n    P2_B:        {c: 82, n: \"R\",  plyr:1, button:1},\n    P2_GP_A:     {c: 69, n: \"E\",  plyr:1, button:0},\n    P2_GP_B:     {c: 82, n: \"R\",  plyr:1, button:1},\n    P2_GP_C:     {c: 84, n: \"T\",  plyr:1, button:2},\n    P2_GP_D:     {c: 89, n: \"Y\",  plyr:1, button:3},\n    P2_SELECT:   {c: 70, n: \"F\",  plyr:1, button:8},\n    P2_START:    {c: 71, n: \"G\",  plyr:1, button:9},\n    // keyboard only\n    VK_ESCAPE: {c: 27, n: \"Esc\"},\n    VK_F1: {c: 112, n: \"F1\"},\n    VK_F2: {c: 113, n: \"F2\"},\n    VK_F3: {c: 114, n: \"F3\"},\n    VK_F4: {c: 115, n: \"F4\"},\n    VK_F5: {c: 116, n: \"F5\"},\n    VK_F6: {c: 117, n: \"F6\"},\n    VK_F7: {c: 118, n: \"F7\"},\n    VK_F8: {c: 119, n: \"F8\"},\n    VK_F9: {c: 120, n: \"F9\"},\n    VK_F10: {c: 121, n: \"F10\"},\n    VK_F11: {c: 122, n: \"F11\"},\n    VK_F12: {c: 123, n: \"F12\"},\n    VK_SCROLL_LOCK: {c: 145, n: \"ScrLck\"},\n    VK_PAUSE: {c: 19, n: \"Pause\"},\n    VK_QUOTE: {c: 222, n: \"'\"},\n    VK_1: {c: 49, n: \"1\"},\n    VK_2: {c: 50, n: \"2\"},\n    VK_3: {c: 51, n: \"3\"},\n    VK_4: {c: 52, n: \"4\"},\n    VK_5: {c: 53, n: \"5\"},\n    VK_6: {c: 54, n: \"6\"},\n    VK_7: {c: 55, n: \"7\"},\n    VK_8: {c: 56, n: \"8\"},\n    VK_9: {c: 57, n: \"9\"},\n    VK_0: {c: 48, n: \"0\"},\n    VK_MINUS: {c: 189, n: \"-\"},\n    VK_MINUS2: {c: 173, n: \"-\"},\n    VK_EQUALS: {c: 187, n: \"=\"},\n    VK_EQUALS2: {c: 61, n: \"=\"},\n    VK_BACK_SPACE: {c: 8, n: \"Bkspc\"},\n    VK_TAB: {c: 9, n: \"Tab\"},\n    VK_Q: {c: 81, n: \"Q\"},\n    VK_W: {c: 87, n: \"W\"},\n    VK_E: {c: 69, n: \"E\"},\n    VK_R: {c: 82, n: \"R\"},\n    VK_T: {c: 84, n: \"T\"},\n    VK_Y: {c: 89, n: \"Y\"},\n    VK_U: {c: 85, n: \"U\"},\n    VK_I: {c: 73, n: \"I\"},\n    VK_O: {c: 79, n: \"O\"},\n    VK_P: {c: 80, n: \"P\"},\n    VK_ACUTE: {c: 219, n: \"\u00B4\"},\n    VK_OPEN_BRACKET: {c: 219, n: \"[\"},\n    VK_CLOSE_BRACKET: {c: 221, n: \"]\"},\n    VK_CAPS_LOCK: {c: 20, n: \"CpsLck\"},\n    VK_A: {c: 65, n: \"A\"},\n    VK_S: {c: 83, n: \"S\"},\n    VK_D: {c: 68, n: \"D\"},\n    VK_F: {c: 70, n: \"F\"},\n    VK_G: {c: 71, n: \"G\"},\n    VK_H: {c: 72, n: \"H\"},\n    VK_J: {c: 74, n: \"J\"},\n    VK_K: {c: 75, n: \"K\"},\n    VK_L: {c: 76, n: \"L\"},\n    VK_CEDILLA: {c: 186, n: \"\u00C7\"},\n    VK_TILDE: {c: 222, n: \"~\"},\n    VK_ENTER: {c: 13, n: \"Enter\"},\n    VK_SHIFT: {c: 16, n: \"Shift\"},\n    VK_BACK_SLASH: {c: 220, n: \"\\\\\"},\n    VK_Z: {c: 90, n: \"Z\"},\n    VK_X: {c: 88, n: \"X\"},\n    VK_C: {c: 67, n: \"C\"},\n    VK_V: {c: 86, n: \"V\"},\n    VK_B: {c: 66, n: \"B\"},\n    VK_N: {c: 78, n: \"N\"},\n    VK_M: {c: 77, n: \"M\"},\n    VK_COMMA: {c: 188, n: \"] =\"},\n    VK_PERIOD: {c: 190, n: \".\"},\n    VK_SEMICOLON: {c: 59, n: \";\"},\n    VK_SLASH: {c: 191, n: \"/\"},\n    VK_CONTROL: {c: 17, n: \"Ctrl\"},\n    VK_ALT: {c: 18, n: \"Alt\"},\n    VK_COMMAND: {c: 224, n: \"Cmd\"},\n    VK_SPACE: {c: 32, n: \"Space\"},\n    VK_INSERT: {c: 45, n: \"Ins\"},\n    VK_DELETE: {c: 46, n: \"Del\"},\n    VK_HOME: {c: 36, n: \"Home\"},\n    VK_END: {c: 35, n: \"End\"},\n    VK_PAGE_UP: {c: 33, n: \"PgUp\"},\n    VK_PAGE_DOWN: {c: 34, n: \"PgDown\"},\n    VK_UP: {c: 38, n: \"Up\"},\n    VK_DOWN: {c: 40, n: \"Down\"},\n    VK_LEFT: {c: 37, n: \"Left\"},\n    VK_RIGHT: {c: 39, n: \"Right\"},\n    VK_NUM_LOCK: {c: 144, n: \"Num\"},\n    VK_DIVIDE: {c: 111, n: \"Num /\"},\n    VK_MULTIPLY: {c: 106, n: \"Num *\"},\n    VK_SUBTRACT: {c: 109, n: \"Num -\"},\n    VK_ADD: {c: 107, n: \"Num +\"},\n    VK_DECIMAL: {c: 194, n: \"Num .\"},\n    VK_NUMPAD0: {c: 96, n: \"Num 0\"},\n    VK_NUMPAD1: {c: 97, n: \"Num 1\"},\n    VK_NUMPAD2: {c: 98, n: \"Num 2\"},\n    VK_NUMPAD3: {c: 99, n: \"Num 3\"},\n    VK_NUMPAD4: {c: 100, n: \"Num 4\"},\n    VK_NUMPAD5: {c: 101, n: \"Num 5\"},\n    VK_NUMPAD6: {c: 102, n: \"Num 6\"},\n    VK_NUMPAD7: {c: 103, n: \"Num 7\"},\n    VK_NUMPAD8: {c: 104, n: \"Num 8\"},\n    VK_NUMPAD9: {c: 105, n: \"Num 9\"},\n    VK_NUMPAD_CENTER: {c: 12, n: \"Num Cntr\"}\n};\n\nfunction _metakeyflags(e) {\n  return (e.shiftKey?KeyFlags.Shift:0) |\n        (e.ctrlKey?KeyFlags.Ctrl:0) | \n        (e.altKey?KeyFlags.Alt:0) | \n        (e.metaKey?KeyFlags.Meta:0);\n}\n\ntype KeyMapFunction = (o:KeyMapEntry, key:number, code:number, flags:number) => void;\n\nexport function newKeyboardHandler(switches:number[]|Uint8Array, map:KeyCodeMap, func?:KeyMapFunction, alwaysfunc?:boolean) {\n  return (key:number,code:number,flags:number) => {\n    if (!map) {\n      func(null, key, code, flags);\n      return;\n    }\n    var o : KeyMapEntry = map[key];\n    if (!o) o = map[0];\n    if (func && (o || alwaysfunc)) {\n      func(o, key, code, flags);\n    }\n    if (o) {\n      //console.log(key,code,flags,o);\n      var mask = o.mask;\n      if (mask < 0) { // negative mask == active low\n        mask = -mask;\n        if (flags & (KeyFlags.KeyDown | KeyFlags.KeyUp))\n          flags ^= KeyFlags.KeyDown | KeyFlags.KeyUp;\n      }\n      if (flags & KeyFlags.KeyDown) {\n        switches[o.index] |= mask;\n      } else if (flags & KeyFlags.KeyUp) {\n        switches[o.index] &= ~mask;\n      }\n    }\n  };\n}\n\nexport function setKeyboardFromMap(video:RasterVideo, switches:number[]|Uint8Array, map:KeyCodeMap, func?:KeyMapFunction, alwaysfunc?:boolean) {\n  var handler = newKeyboardHandler(switches, map, func, alwaysfunc);\n  video.setKeyboardEvents(handler);\n  return new ControllerPoller(handler);\n}\n\nexport function makeKeycodeMap(table : [KeyDef,number,number][]) : KeyCodeMap {\n  var map = new Map<number,KeyMapEntry>();\n  for (var i=0; i<table.length; i++) {\n    var entry = table[i];\n    var val : KeyMapEntry = {index:entry[1], mask:entry[2], def:entry[0]};\n    map[entry[0].c] = val;\n  }\n  return map;\n}\n\nconst DEFAULT_CONTROLLER_KEYS : KeyDef[] = [\n  Keys.UP, Keys.DOWN, Keys.LEFT, Keys.RIGHT, Keys.A, Keys.B, Keys.SELECT, Keys.START,\n  Keys.P2_UP, Keys.P2_DOWN, Keys.P2_LEFT, Keys.P2_RIGHT, Keys.P2_A, Keys.P2_B, Keys.P2_SELECT, Keys.P2_START,\n];\n\nexport class ControllerPoller {\n  active = false;\n  handler;\n  state : Int32Array[];\n  lastState : Int32Array[];\n  AXIS0 = 24; // first joystick axis index\n  constructor(handler:(key,code,flags) => void) {\n    this.handler = handler;\n    window.addEventListener(\"gamepadconnected\", (event) => {\n      console.log(\"Gamepad connected:\", event);\n      this.reset();\n    });\n    window.addEventListener(\"gamepaddisconnected\", (event) => {\n      console.log(\"Gamepad disconnected:\", event);\n      this.reset();\n    });\n  }\n  reset() {\n    this.active = typeof navigator.getGamepads === 'function';\n    if (this.active) {\n      let numGamepads = navigator.getGamepads().length;\n      this.state = new Array(numGamepads);\n      this.lastState = new Array(numGamepads);\n      for (var i=0; i<numGamepads; i++) {\n        this.state[i] = new Int32Array(64);\n        this.lastState[i] = new Int32Array(64);\n      }\n      console.log(this);\n    }\n  }\n  poll() {\n    if (!this.active) return;\n    var gamepads = navigator.getGamepads();\n    for (var gpi=0; gpi<gamepads.length; gpi++) {\n      let state = this.state[gpi];\n      let lastState = this.lastState[gpi];\n      var gp = gamepads[gpi];\n      if (gp) {\n        for (var i=0; i<gp.axes.length; i++) {\n          var k = i + this.AXIS0;\n          state[k] = Math.round(gp.axes[i]);\n          if (state[k] != lastState[k]) {\n            this.handleStateChange(gpi,k);\n          }\n        }\n        for (var i=0; i<gp.buttons.length; i++) {\n          state[i] = gp.buttons[i].pressed ? 1 : 0;\n          if (state[i] != lastState[i]) {\n            this.handleStateChange(gpi,i);\n          }\n        }\n        lastState.set(state);\n      }\n    }\n  }\n  handleStateChange(gpi:number, k:number) {\n    var axis = k - this.AXIS0;\n    // TODO: this is slow\n    for (var def of DEFAULT_CONTROLLER_KEYS) {\n      // is this a gamepad entry? same player #?\n      if (def && def.plyr == gpi) {\n        var code = def.c;\n        var state = this.state[gpi][k];\n        var lastState = this.lastState[gpi][k];\n        // check for button/axis match\n        if (k == def.button || (axis == 0 && def.xaxis == state) || (axis == 1 && def.yaxis == state)) {\n          //console.log(\"Gamepad\", gpi, code, state);\n          if (state != 0) {\n            this.handler(code, 0, KeyFlags.KeyDown);\n          } else {\n            this.handler(code, 0, KeyFlags.KeyUp);\n          }\n          break;\n        }\n        // joystick released?\n        else if (state == 0 && (axis == 0 && def.xaxis == lastState) || (axis == 1 && def.yaxis == lastState)) {\n          this.handler(code, 0, KeyFlags.KeyUp);\n          break;\n        }\n      }\n    }\n  }\n}\n\n\nexport function padBytes(data:Uint8Array|number[], len:number, padstart?:boolean) : Uint8Array {\n  if (data.length > len) {\n    throw Error(\"Data too long, \" + data.length + \" > \" + len);\n  }\n  var r = new RAM(len);\n  if (padstart)\n    r.mem.set(data, len-data.length);\n  else\n    r.mem.set(data);\n  return r.mem;\n}\n\ntype AddressReadWriteFn = ((a:number) => number) | ((a:number,v:number) => void);\ntype AddressDecoderEntry = [number, number, number, AddressReadWriteFn];\ntype AddressDecoderOptions = {gmask?:number, defaultval?:number};\n\n// TODO: better performance, check values\nexport function AddressDecoder(table : AddressDecoderEntry[], options?:AddressDecoderOptions) {\n  var self = this;\n  function makeFunction() {\n    var s = \"\";\n    if (options && options.gmask) {\n      s += \"a&=\" + options.gmask + \";\";\n    }\n    for (var i=0; i<table.length; i++) {\n      var entry = table[i];\n      var start = entry[0]|0;\n      var end = entry[1]|0;\n      var mask = entry[2]|0;\n      var func = entry[3];\n      self['__fn'+i] = func;\n      s += \"if (a>=\" + start + \" && a<=\"+end + \"){\";\n      if (mask) s += \"a&=\"+mask+\";\";\n      s += \"return this.__fn\"+i+\"(a,v)&0xff;}\\n\";\n    }\n    s += \"return \"+(options?.defaultval|0)+\";\";\n    return new Function('a', 'v', s);\n  }\n  return makeFunction().bind(self);\n}\n\nexport function newAddressDecoder(table : AddressDecoderEntry[], options?:AddressDecoderOptions) : (a:number,v?:number) => number {\n  return new (AddressDecoder as any)(table, options);\n}\n\n\n// https://stackoverflow.com/questions/17130395/real-mouse-position-in-canvas\nexport function getMousePos(canvas : HTMLCanvasElement, evt) : {x:number,y:number} {\n  var rect = canvas.getBoundingClientRect(), // abs. size of element\n      scaleX = canvas.width / rect.width,    // relationship bitmap vs. element for X\n      scaleY = canvas.height / rect.height;  // relationship bitmap vs. element for Y\n\n  return {\n    x: (evt.clientX - rect.left) * scaleX,   // scale mouse coordinates after they have\n    y: (evt.clientY - rect.top) * scaleY     // been adjusted to be relative to element\n  }\n}\n\n///\n\n// TODO: https://stackoverflow.com/questions/10463518/converting-em-to-px-in-javascript-and-getting-default-font-size\nexport function getVisibleEditorLineHeight() : number{\n  return $(\"#booksMenuButton\").first().height();\n}\n\nexport interface VirtualTextLine {\n  text : string;\n  clas? : string;\n}\n\nexport class VirtualTextScroller {\n  memorylist;\n  maindiv : HTMLElement;\n  getLineAt : (row:number) => VirtualTextLine;\n\n  constructor(parent : HTMLElement) {\n    var div = document.createElement('div');\n    div.setAttribute(\"class\", \"memdump\");\n    parent.appendChild(div);\n    this.maindiv = div;\n  }\n  \n  create(workspace : HTMLElement, maxRowCount : number, fn : (row:number) => VirtualTextLine) {\n    this.getLineAt = fn;\n    this.memorylist = new VirtualList({\n      w: $(workspace).width(),\n      h: $(workspace).height(),\n      itemHeight: getVisibleEditorLineHeight(),\n      totalRows: maxRowCount, // TODO?\n      generatorFn: (row : number) => {\n        var line = fn(row);\n        var linediv = document.createElement(\"div\");\n        linediv.appendChild(document.createTextNode(line.text));\n        if (line.clas != null) linediv.className = line.clas;\n        return linediv;\n      }\n    });\n    $(this.maindiv).append(this.memorylist.container);\n  }\n\n  // TODO: refactor with elsewhere\n  refresh() {\n    if (this.memorylist) {\n      $(this.maindiv).find('[data-index]').each( (i,e) => {\n        var div = e;\n        var row = parseInt(div.getAttribute('data-index'));\n        var oldtext = div.innerText;\n        var line = this.getLineAt(row);\n        var newtext = line.text;\n        if (oldtext != newtext) {\n          div.innerText = newtext;\n          if (line.clas != null && !div.classList.contains(line.clas)) {\n            var oldclasses = Array.from(div.classList);\n            oldclasses.forEach((c) => div.classList.remove(c));\n            div.classList.add('vrow');\n            div.classList.add(line.clas);\n          }\n        }\n      });\n    }\n  }\n}\n\n// https://forums.atariage.com/topic/107853-need-the-256-colors/page/2/\nexport function gtia_ntsc_to_rgb(val: number) {\n  const gamma = 0.9;\n  const bright = 1.1;\n  const color = 60;\n  let cr = (val >> 4) & 15;\n  let lm = val & 15;\n  let crlv = cr ? color : 0;\n  if (cr) lm += 1;\n  let phase = ((cr - 1) * 25 - 25) * (2 * Math.PI / 360);\n  let y = 256 * bright * Math.pow(lm / 16, gamma);\n  let i = crlv * Math.cos(phase);\n  let q = crlv * Math.sin(phase);\n  var r = y + 0.956 * i + 0.621 * q;\n  var g = y - 0.272 * i - 0.647 * q;\n  var b = y - 1.107 * i + 1.704 * q;\n  return RGBA(clamp(0,255,r), clamp(0,255,g), clamp(0,255,b));\n}\n"],
  "mappings": "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",
  "names": ["lpad", "s", "n", "rpad", "byte2signed", "b", "getFilenameForPath", "toks", "getFolderForPath", "getFilenamePrefix", "pos", "hex", "v", "nd", "toradix", "tobin", "radix", "e", "arrayCompare", "a", "i", "invertMap", "m", "r", "k", "highlightDifferences", "s1", "s2", "split1", "split2", "j", "result", "w1", "w2", "lzgmini", "LZG_HEADER_SIZE", "LZG_METHOD_COPY", "LZG_METHOD_LZG1", "LZG_LENGTH_DECODE_LUT", "outdata", "calcChecksum", "data", "uncomplen", "checksum", "dst", "method", "m1", "m2", "m3", "m4", "symbol", "b2", "b3", "len", "offset", "dstlen", "datalen", "byteArrayToString", "byteArrayToUTF8", "stringToByteArray", "str", "charLUT", "c", "isProbablyBinary", "path", "data", "score", "BINEXTS", "ext", "c", "nextra", "compressLZG", "em_module", "inBuffer", "levelArg", "level", "inLen", "inPtr", "i", "maxEncSize", "outPtr", "compLen", "outBuffer", "safe_extend", "deep", "dest", "src", "key", "val", "type", "printFlags", "names", "r2l", "s", "bit", "rgb2bgr", "x", "RGBA", "r", "g", "b", "clamp", "minv", "maxv", "v", "safeident", "rle_unpack", "tag", "ch", "count", "j", "getWithBinary", "url", "success", "datatype", "oReq", "oEvent", "getBasePlatform", "platform", "getRootPlatform", "getRootBasePlatform", "isArray", "obj", "isTypedArray", "convertDataToUint8Array", "stringToByteArray", "byteToASCII", "b", "loadScript", "scriptfn", "resolve", "reject", "script", "decodeQueryString", "qs", "a", "i", "p", "parseBool", "s", "getCookie", "name", "nameEQ", "ca", "i", "c", "VirtualList", "config", "width", "height", "itemHeight", "scroller", "screenItemsLen", "self", "lastRepaintY", "maxBuffer", "lastScrolled", "badNodes", "i", "l", "e", "onScroll", "scrollTop", "first", "item", "itemText", "node", "from", "finalItem", "fragment", "j", "w", "h", "c", "index", "PLATFORMS", "_random_state", "noise", "x", "getNoiseSeed", "setNoiseSeed", "__createCanvas", "doc", "mainElement", "width", "height", "canvas", "_setKeyboardEvents", "canvas", "callback", "e", "flags", "_metakeyflags", "RasterVideo", "mainElement", "width", "height", "options", "rotate", "doc", "__createCanvas", "sx", "sy", "dx", "dy", "w", "h", "ctx", "el", "pos", "getMousePos", "new_x", "new_y", "clamp", "VectorVideo", "x1", "y1", "x2", "y2", "intensity", "color", "alpha", "jx", "jy", "drawCrosshair", "x", "y", "RAM", "size", "EmuHalt", "_EmuHalt", "msg", "loc", "useRequestAnimationFrame", "AnimationTimer", "frequencyHz", "msec", "fn", "timestamp", "ts", "dumpRAM", "ram", "ramofs", "ramlen", "s", "bpel", "perline", "isFloat", "ofs", "hex", "i", "Keys", "newKeyboardHandler", "switches", "map", "func", "alwaysfunc", "key", "code", "mask", "setKeyboardFromMap", "video", "handler", "ControllerPoller", "makeKeycodeMap", "table", "entry", "val", "DEFAULT_CONTROLLER_KEYS", "event", "numGamepads", "gamepads", "gpi", "state", "lastState", "gp", "k", "axis", "def", "padBytes", "data", "len", "padstart", "r", "AddressDecoder", "self", "makeFunction", "start", "end", "newAddressDecoder", "evt", "rect", "scaleX", "scaleY", "getVisibleEditorLineHeight", "VirtualTextScroller", "parent", "div", "workspace", "maxRowCount", "VirtualList", "row", "line", "linediv", "oldtext", "newtext", "oldclasses", "c", "gtia_ntsc_to_rgb", "cr", "lm", "crlv", "phase", "q", "g", "b", "RGBA"]
}
